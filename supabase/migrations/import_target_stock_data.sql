-- Import target stock data from old database
-- This script imports target stock data, filtering out NULL values and duplicates

WITH cleaned_data AS (
  SELECT DISTINCT
    houtsoort,
    dikte::INTEGER as dikte,
    breedte::INTEGER as breedte,
    target_packs,
    desired_length
  FROM (
    VALUES
    ('NHV', 16.00, 100.00, 1, 4800),
    ('SXT', 19.00, 100.00, 1, 5000),
    ('SXT', 16.00, 100.00, 1, 5100),
    ('NHV', 16.00, 100.00, 1, 5400),
    ('NHV', 19.00, 75.00, 1, 4500),
    ('NHV', 19.00, 75.00, 1, 5100),
    ('SXT', 19.00, 100.00, 1, 4500),
    ('SXT', 19.00, 100.00, 1, 5100),
    ('SXT', 19.00, 100.00, 1, 4000),
    ('NHV', 19.00, 100.00, 1, 5000),
    ('NHV', 19.00, 100.00, 1, 4500),
    ('NHV', 19.00, 150.00, 1, 4500),
    ('NHV', 19.00, 150.00, 1, 5100),
    ('NHV', 22.00, 75.00, 1, 4500),
    ('NHV', 22.00, 75.00, 1, 5100),
    ('NHV', 22.00, 100.00, 1, 4500),
    ('NHV', 22.00, 100.00, 1, 4800),
    ('NHV', 22.00, 100.00, 1, 5100),
    ('SXT', 22.00, 100.00, 1, 4800),
    ('SXT', 22.00, 100.00, 1, 5100),
    ('NHV', 22.00, 150.00, 1, 4800),
    ('NHV', 22.00, 150.00, 1, 5400),
    ('SXT', 16.00, 100.00, 1, 4800),
    ('NHV', 19.00, 100.00, 1, 5400),
    ('SXT', 25.00, 100.00, 1, 5100),
    ('NHV', 32.00, 100.00, 1, 3600),
    ('NHV', 32.00, 100.00, 1, 5000),
    ('NHV', 32.00, 100.00, 1, 6000),
    ('NHV', 32.00, 150.00, 1, 4000),
    ('NHV', 32.00, 150.00, 1, 6000),
    ('NHV', 32.00, 150.00, 1, 5000),
    ('NHV', 38.00, 100.00, 1, 4000),
    ('NHV', 38.00, 100.00, 1, 5000),
    ('NHV', 38.00, 150.00, 1, 4000),
    ('NHV', 38.00, 150.00, 1, 5000),
    ('NHV', 50.00, 75.00, 1, 5100),
    ('NHV', 50.00, 100.00, 1, 4000),
    ('NHV', 50.00, 100.00, 1, 4500),
    ('NHV', 50.00, 100.00, 1, 5100),
    ('NHV', 50.00, 100.00, 1, 6000),
    ('NHV', 50.00, 200.00, 1, 5100),
    ('NHV', 50.00, 150.00, 1, 4000),
    ('NHV', 50.00, 150.00, 1, 5000),
    ('NHV', 50.00, 150.00, 1, 7000),
    ('NHV', 75.00, 75.00, 1, 4000),
    ('NHV', 75.00, 75.00, 1, 5000),
    ('NHV', 75.00, 75.00, 1, 6000),
    ('NHV', 75.00, 100.00, 1, 5000),
    ('NHV', 75.00, 100.00, 1, 6000),
    ('SXT', 75.00, 100.00, 1, 5000),
    ('SXT', 75.00, 100.00, 1, 6000),
    ('NHV', 75.00, 150.00, 1, 4000),
    ('NHV', 75.00, 200.00, 1, 4000),
    ('NHV', 75.00, 200.00, 1, 5000),
    ('NHV', 75.00, 200.00, 1, 4500),
    ('NHV', 95.00, 95.00, 1, 3000),
    ('NHV', 95.00, 95.00, 1, 4000),
    ('NHV', 95.00, 95.00, 1, 5100),
    ('SXT', 100.00, 100.00, 2, 5100),
    ('NHV', 95.00, 125.00, 1, 5100),
    ('NHV', 95.00, 150.00, 1, 4000),
    ('NHV', 95.00, 150.00, 1, 5100),
    ('MEP', 9.00, 1220.00, 6, 2440),
    ('MEP', 15.00, 1220.00, 6, 2440),
    ('MEP', 18.00, 1220.00, 2, 2440),
    ('OSB', 9.00, 1220.00, 6, 2440),
    ('NHV', 32.00, 125.00, 1, 4500),
    ('NHV', 75.00, 150.00, 1, 8000),
    ('NHV', 75.00, 150.00, 1, 6000),
    ('NHV', 50.00, 75.00, 1, 4500)
  ) AS imported_data(houtsoort, dikte, breedte, target_packs, desired_length)
  WHERE houtsoort IS NOT NULL 
    AND dikte IS NOT NULL 
    AND breedte IS NOT NULL 
    AND target_packs IS NOT NULL
)
INSERT INTO wood_target_stock (houtsoort, dikte, breedte, target_packs, desired_length)
SELECT houtsoort, dikte, breedte, target_packs, desired_length
FROM cleaned_data
ON CONFLICT (houtsoort, dikte, breedte, desired_length) DO NOTHING;

